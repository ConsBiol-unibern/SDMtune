<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SDMtune">
<title>Data-driven variable selection • SDMtune</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Data-driven variable selection">
<meta property="og:description" content="SDMtune">
<meta property="og:image" content="https://consbiol-unibern.github.io/SDMtune/logo.png">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SDMtune</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.2.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/articles/prepare-data.html">Prepare data for the analysis</a>
    <a class="dropdown-item" href="../articles/articles/train-model.html">Train a model</a>
    <a class="dropdown-item" href="../articles/articles/make-predictions.html">Make predictions</a>
    <a class="dropdown-item" href="../articles/articles/evaluate-model.html">Evaluate a model</a>
    <a class="dropdown-item" href="../articles/articles/evaluation-strategies.html">Evaluation strategies</a>
    <a class="dropdown-item" href="../articles/articles/variable-importance.html">Variable importance</a>
    <a class="dropdown-item" href="../articles/articles/variable-selection.html">Data-driven variable selection</a>
    <a class="dropdown-item" href="../articles/articles/tune-hyperparameters.html">Tune model hyperparameters</a>
    <a class="dropdown-item" href="../articles/articles/train-tune-presence-absence-models.html">Train and tune presence absence models</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ConsBiol-unibern/SDMtune">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="variable-selection_files/kePrint-0.0.1/kePrint.js"></script><link href="variable-selection_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Data-driven variable selection</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ConsBiol-unibern/SDMtune/blob/HEAD/vignettes/articles/variable-selection.Rmd" class="external-link"><code>vignettes/articles/variable-selection.Rmd</code></a></small>
      <div class="d-none name"><code>variable-selection.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="intro">Intro<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<p>In the previous articles you have learned the core functions of
<strong>SDMtune</strong> for training, evaluating and display the output
of a model. In this article you will learn how to perform data-driven
variable selection.</p>
</div>
<div class="section level2">
<h2 id="explore-variable-correlation">Explore variable correlation<a class="anchor" aria-label="anchor" href="#explore-variable-correlation"></a>
</h2>
<p>We extract 10000 background locations using the function <a href="https://www.rdocumentation.org/packages/dismo/versions/1.1-4/topics/randomPoints" class="external-link">randomPoints</a>
included in the <code>dismo</code> package (we set the seed to have
reproducible results). After we create an <code><a href="../reference/SWD-class.html">SWD()</a></code> object
using the <code><a href="../reference/prepareSWD.html">prepareSWD()</a></code> function:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span></span>
<span><span class="va">bg</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/sample.html" class="external-link">spatSample</a></span><span class="op">(</span><span class="va">predictors</span>,</span>
<span>                        size <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                        method <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>                        na.rm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                        xy <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                        values <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepareSWD.html">prepareSWD</a></span><span class="op">(</span>species <span class="op">=</span> <span class="st">"Bgs"</span>, </span>
<span>                 a <span class="op">=</span> <span class="va">bg</span>, </span>
<span>                 env <span class="op">=</span> <span class="va">predictors</span>, </span>
<span>                 categorical <span class="op">=</span> <span class="st">"biome"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Warning: [spatSample] fewer cells returned than requested</span></span></code></pre>
<p>The environmental variables we downloaded have a coarse resolution
and the function can extract a bit less than 10000 random locations (see
the warning message).</p>
<p>With the function <code><a href="../reference/plotCor.html">plotCor()</a></code> you can create an heat map
showing the degree of autocorrelation:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotCor.html">plotCor</a></span><span class="op">(</span><span class="va">bg</span>, </span>
<span>        method <span class="op">=</span> <span class="st">"spearman"</span>, </span>
<span>        cor_th <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="variable-selection_files/figure-html/heat%20map-1.png" width="700" style="display: block; margin: auto;"></p>
<p>You can select a different correlation method or set a different
correlation threshold. Another useful function is <code><a href="../reference/corVar.html">corVar()</a></code>
that instead of creating a heat map prints the pairs of correlated
variables according to the given method and correlation threshold:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/corVar.html">corVar</a></span><span class="op">(</span><span class="va">bg</span>, </span>
<span>       method <span class="op">=</span> <span class="st">"spearman"</span>, </span>
<span>       cor_th <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Var1
</th>
<th style="text-align:left;">
Var2
</th>
<th style="text-align:right;">
value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
bio1
</td>
<td style="text-align:left;">
bio6
</td>
<td style="text-align:right;">
0.9513541
</td>
</tr>
<tr>
<td style="text-align:left;">
bio12
</td>
<td style="text-align:left;">
bio16
</td>
<td style="text-align:right;">
0.9447559
</td>
</tr>
<tr>
<td style="text-align:left;">
bio6
</td>
<td style="text-align:left;">
bio7
</td>
<td style="text-align:right;">
-0.8734498
</td>
</tr>
<tr>
<td style="text-align:left;">
bio1
</td>
<td style="text-align:left;">
bio8
</td>
<td style="text-align:right;">
0.8459649
</td>
</tr>
<tr>
<td style="text-align:left;">
bio16
</td>
<td style="text-align:left;">
bio6
</td>
<td style="text-align:right;">
0.7471269
</td>
</tr>
<tr>
<td style="text-align:left;">
bio6
</td>
<td style="text-align:left;">
bio8
</td>
<td style="text-align:right;">
0.7286723
</td>
</tr>
<tr>
<td style="text-align:left;">
bio1
</td>
<td style="text-align:left;">
bio7
</td>
<td style="text-align:right;">
-0.7119135
</td>
</tr>
<tr>
<td style="text-align:left;">
bio16
</td>
<td style="text-align:left;">
bio7
</td>
<td style="text-align:right;">
-0.7027568
</td>
</tr>
<tr>
<td style="text-align:left;">
bio1
</td>
<td style="text-align:left;">
bio16
</td>
<td style="text-align:right;">
0.7023585
</td>
</tr>
</tbody>
</table>
<p>As you can see there are few variables that have a correlation
coefficient greater than 0.7 in absolute value.</p>
</div>
<div class="section level2">
<h2 id="remove-highly-correlated-variables">Remove highly correlated variables<a class="anchor" aria-label="anchor" href="#remove-highly-correlated-variables"></a>
</h2>
<p><strong>SDMtune</strong> implements an algorithm that removes highly
correlated variables repeating the following steps:</p>
<ol style="list-style-type: decimal">
<li>ranks the variables according to the permutation importance or the
percent contribution (the second method is available only for Maxent
models).</li>
<li>checks if the variable ranked as most important is highly correlated
with other variables, according to the given method and correlation
threshold. If the algorithm finds correlated variables it moves to the
next step, otherwise checks the other variables in the rank;</li>
<li>performs a leave one out Jackknife test among the correlated
variables;</li>
<li>remove the variable that decreases the less the model performance
when removed, according to the given metric on the training
dataset.</li>
</ol>
<p>The process is repeated until the remaining variables have a
correlation coefficient lower than the provided correlation threshold.
In the next example we remove the variables that have a
<strong>Spearman</strong> correlation coefficient <span class="math inline">\(|r_s|\leq0.7\)</span> and checking the AUC on the
training dataset (we use only one permutation to save time but you are
free to increase this value). If you use RStudio, the function creates
an interactive real-time chart in the viewer pane. Run the following
code and hover over the chart during the execution of the function to
get extra information:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">selected_variables_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/varSel.html">varSel</a></span><span class="op">(</span><span class="va">maxnet_model</span>, </span>
<span>                                   metric <span class="op">=</span> <span class="st">"auc"</span>, </span>
<span>                                   test <span class="op">=</span> <span class="va">test</span>, </span>
<span>                                   bg4cor <span class="op">=</span> <span class="va">bg</span>, </span>
<span>                                   method <span class="op">=</span> <span class="st">"spearman"</span>, </span>
<span>                                   cor_th <span class="op">=</span> <span class="fl">0.7</span>, </span>
<span>                                   permut <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> The variables <span style="color: #00BB00;">bio16</span>, <span style="color: #00BB00;">bio6</span>, <span style="color: #00BB00;">bio7</span>, and <span style="color: #00BB00;">bio8</span> have been removed</span></span></code></pre>
<p>As you can see some variables have been removed. The output of the
function is the model trained with the selected variables:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">selected_variables_model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Object of class: </span><span style="color: #0000BB; font-weight: bold;">&lt;SDMmodel&gt;</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: <span style="font-style: italic;">Maxnet</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Hyperparameters</span></span>
<span><span class="co">#&gt; • <span style="color: #00BB00;">fc</span>: <span style="color: #0000BB;">"lqph"</span></span></span>
<span><span class="co">#&gt; • <span style="color: #00BB00;">reg</span>: <span style="color: #0000BB;">1</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Info</span></span>
<span><span class="co">#&gt; • <span style="color: #00BB00;">Species</span>: <span style="font-style: italic;">Virtual species</span></span></span>
<span><span class="co">#&gt; • <span style="color: #00BB00;">Presence locations</span>: <span style="color: #0000BB;">320</span></span></span>
<span><span class="co">#&gt; • <span style="color: #00BB00;">Absence locations</span>: <span style="color: #0000BB;">5000</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Variables</span></span>
<span><span class="co">#&gt; • <span style="color: #00BB00;">Continuous</span>: <span style="color: #0000BB;">"bio1"</span>, <span style="color: #0000BB;">"bio12"</span>, <span style="color: #0000BB;">"bio17"</span>, and <span style="color: #0000BB;">"bio5"</span></span></span>
<span><span class="co">#&gt; • <span style="color: #00BB00;">Categorical</span>: <span style="color: #0000BB;">"biome"</span></span></span></code></pre></div>
<div class="section level3">
<h3 id="try-yourself">Try yourself<a class="anchor" aria-label="anchor" href="#try-yourself"></a>
</h3>
<p>Remove highly correlated variables using the
<code>default_model</code>, ranking the variables with the percent
contribution and using the AICc as evaluation metric. Check the help of
the function <code><a href="../reference/varSel.html">varSel()</a></code> and highlight the next cell to see
the solution:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># You need to pass the env argument for the AICc and the use_pc argument to use the percent contribution</span></span>
<span><span class="va">selected_variables_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/varSel.html">varSel</a></span><span class="op">(</span><span class="va">default_model</span>, </span>
<span>                                   metric <span class="op">=</span> <span class="st">"aicc"</span>, </span>
<span>                                   bg4cor <span class="op">=</span> <span class="va">bg</span>, </span>
<span>                                   method <span class="op">=</span> <span class="st">"spearman"</span>, </span>
<span>                                   cor_th <span class="op">=</span> <span class="fl">0.7</span>, </span>
<span>                                   env <span class="op">=</span> <span class="va">predictors</span>, </span>
<span>                                   use_pc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="remove-variables-with-low-importance">Remove variables with low importance<a class="anchor" aria-label="anchor" href="#remove-variables-with-low-importance"></a>
</h2>
<p>There are cases in which a model has some environmental variables
ranked with very low contribution and you may want to remove some of
them to reduce the model complexity. <strong>SDMtune</strong> offers two
different strategies implemented in the function
<code><a href="../reference/reduceVar.html">reduceVar()</a></code>. We will use the <code>maxnet_model</code>
trained with all the variables. Let’s first check the permutation
importance (we use only one permutation to save time):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/varImp.html">varImp</a></span><span class="op">(</span><span class="va">maxnet_model</span>, </span>
<span>       permut <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Permutation_importance
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
bio1
</td>
<td style="text-align:right;">
56.1
</td>
</tr>
<tr>
<td style="text-align:left;">
bio8
</td>
<td style="text-align:right;">
19.5
</td>
</tr>
<tr>
<td style="text-align:left;">
bio17
</td>
<td style="text-align:right;">
6.3
</td>
</tr>
<tr>
<td style="text-align:left;">
biome
</td>
<td style="text-align:right;">
4.7
</td>
</tr>
<tr>
<td style="text-align:left;">
bio12
</td>
<td style="text-align:right;">
3.5
</td>
</tr>
<tr>
<td style="text-align:left;">
bio5
</td>
<td style="text-align:right;">
3.5
</td>
</tr>
<tr>
<td style="text-align:left;">
bio7
</td>
<td style="text-align:right;">
3.2
</td>
</tr>
<tr>
<td style="text-align:left;">
bio6
</td>
<td style="text-align:right;">
1.6
</td>
</tr>
<tr>
<td style="text-align:left;">
bio16
</td>
<td style="text-align:right;">
1.5
</td>
</tr>
</tbody>
</table>
<p>We will use the function <code><a href="../reference/reduceVar.html">reduceVar()</a></code> only for
demonstration purpose. In the first example we want to remove all the
environmental variables that have a permutation importance lower than
6%, no matter if the model performance decreases. The function removes
the last ranked environmental variable, trains a new model and computes
a new rank. The process is repeated until all the remaining
environmental variables have an importance greater than 6%:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Testing AUC before: "</span>, <span class="fu"><a href="../reference/auc.html">auc</a></span><span class="op">(</span><span class="va">maxnet_model</span>, test <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Testing AUC before:  0.8505888</span></span>
<span></span>
<span><span class="va">reduced_variables_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reduceVar.html">reduceVar</a></span><span class="op">(</span><span class="va">maxnet_model</span>, </span>
<span>                                     th <span class="op">=</span> <span class="fl">6</span>, </span>
<span>                                     metric <span class="op">=</span> <span class="st">"auc"</span>, </span>
<span>                                     test <span class="op">=</span> <span class="va">test</span>, </span>
<span>                                     permut <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> The variables <span style="color: #00BB00;">bio16</span>, <span style="color: #00BB00;">bio6</span>, <span style="color: #00BB00;">bio7</span>, <span style="color: #00BB00;">bio5</span>, <span style="color: #00BB00;">bio17</span>, and <span style="color: #00BB00;">biome</span> have been removed</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Testing AUC after: "</span>, <span class="fu"><a href="../reference/auc.html">auc</a></span><span class="op">(</span><span class="va">reduced_variables_model</span>, test <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Testing AUC after:  0.8520787</span></span></code></pre></div>
<p>In the second example we want to remove the environmental variables
that have a permutation importance lower than 15% only if removing the
variables the model performance does not decrease, according to the
given metric. In this case the function performs a leave one out
Jackknife test and remove the environmental variables in a step-wise
fashion as described in the previous example, but only if the model
performance doesn’t drop:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Testing AUC before: "</span>, <span class="fu"><a href="../reference/auc.html">auc</a></span><span class="op">(</span><span class="va">maxnet_model</span>, test <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Testing AUC before:  0.8505888</span></span>
<span></span>
<span><span class="va">reduced_variables_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reduceVar.html">reduceVar</a></span><span class="op">(</span><span class="va">maxnet_model</span>, </span>
<span>                                     th <span class="op">=</span> <span class="fl">15</span>, </span>
<span>                                     metric <span class="op">=</span> <span class="st">"auc"</span>, </span>
<span>                                     test <span class="op">=</span> <span class="va">test</span>, </span>
<span>                                     permut <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                     use_jk <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> The variables <span style="color: #00BB00;">bio16</span>, <span style="color: #00BB00;">bio6</span>, <span style="color: #00BB00;">bio5</span>, <span style="color: #00BB00;">bio12</span>, <span style="color: #00BB00;">biome</span>, and <span style="color: #00BB00;">bio8</span> have been removed</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Testing AUC after: "</span>, <span class="fu"><a href="../reference/auc.html">auc</a></span><span class="op">(</span><span class="va">reduced_variables_model</span>, test <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Testing AUC after:  0.8533188</span></span></code></pre></div>
<p>As you can see in this case several variables have been removed and
the AUC in the testing dataset didn’t decrease.</p>
<div class="section level3">
<h3 id="try-yourself-1">Try yourself<a class="anchor" aria-label="anchor" href="#try-yourself-1"></a>
</h3>
<p>Reduce the number of variables using the model trained with the <a href="./evaluation-strategies.html#cross-validation">cross
validation</a> and using as metric the TSS. Highlight the following cell
for the solution:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># You need to pass TRUE to the test argument</span></span>
<span><span class="va">selected_variables_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reduceVar.html">reduceVar</a></span><span class="op">(</span><span class="va">cv_model</span>, </span>
<span>                                      th <span class="op">=</span> <span class="fl">6</span>, </span>
<span>                                      metric <span class="op">=</span> <span class="st">"tss"</span>, </span>
<span>                                      test <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                      permut <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>In this article you have learned:</p>
<ul>
<li>how to explore the correlation between the environmental
variables;</li>
<li>a possible approach to remove highly correlated environmental
variables;</li>
<li>two possible methods to remove environmental variables with low
importance.</li>
</ul>
<p>In the <a href="./tune-hyperparameters.html">next article</a> you
will learn how to tune the model hyperparameters.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/sgvignali" class="external-link">Sergio Vignali</a>, <a href="http://www.cb.iee.unibe.ch/about_us/barras_arnaud_gian/index_eng.html" class="external-link">Arnaud Barras</a>, <a href="http://www.cb.iee.unibe.ch/about_us/dr_braunisch_veronika/index_eng.html" class="external-link">Veronika Braunisch</a>, <a href="http://www.cb.iee.unibe.ch/index_eng.html" class="external-link">Conservation Biology - University of Bern</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
