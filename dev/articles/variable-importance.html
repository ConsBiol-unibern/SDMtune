<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SDMtune">
<title>Variable Importance • SDMtune</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Variable Importance">
<meta property="og:description" content="SDMtune">
<meta property="og:image" content="https://consbiol-unibern.github.io/SDMtune/logo.png">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SDMtune</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.3.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/articles/prepare-data.html">Prepare data for the analysis</a>
    <a class="dropdown-item" href="../articles/articles/train-model.html">Train a model</a>
    <a class="dropdown-item" href="../articles/articles/make-predictions.html">Make predictions</a>
    <a class="dropdown-item" href="../articles/articles/evaluate-model.html">Evaluate a model</a>
    <a class="dropdown-item" href="../articles/articles/evaluation-strategies.html">Evaluation strategies</a>
    <a class="dropdown-item" href="../articles/articles/variable-importance.html">Variable importance</a>
    <a class="dropdown-item" href="../articles/articles/variable-selection.html">Data-driven variable selection</a>
    <a class="dropdown-item" href="../articles/articles/tune-hyperparameters.html">Tune model hyperparameters</a>
    <a class="dropdown-item" href="../articles/articles/train-tune-presence-absence-models.html">Train and tune presence absence models</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ConsBiol-unibern/SDMtune">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="variable-importance_files/kePrint-0.0.1/kePrint.js"></script><link href="variable-importance_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Variable Importance</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ConsBiol-unibern/SDMtune/blob/HEAD/vignettes/articles/variable-importance.Rmd" class="external-link"><code>vignettes/articles/variable-importance.Rmd</code></a></small>
      <div class="d-none name"><code>variable-importance.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="intro">Intro<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<p>In the previous articles you have learned how to <a href="./prepare-data.html">prepare the data</a> for the analysis, how to
<a href="./train-model.html">train a model</a>, how to <a href="./make-predictions.html">make predictions</a>, how to <a href="./evaluate-model.html">evaluate a model</a> and two different <a href="./evaluation-strategies.html">evaluation strategies</a> using
<strong>SDMtune</strong>. In this article you will learn how to display
and plot the variable importance and how to plot the response
curves.</p>
</div>
<div class="section level2">
<h2 id="variable-importance-for-maxent-models">Variable importance for Maxent models<a class="anchor" aria-label="anchor" href="#variable-importance-for-maxent-models"></a>
</h2>
<p>First we load the <strong>SDMtune</strong> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://consbiol-unibern.github.io/SDMtune/">SDMtune</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    _____  ____   __  ___ __</span></span>
<span><span class="co">#&gt;   / ___/ / __ \ /  |/  // /_ __  __ ____   ___</span></span>
<span><span class="co">#&gt;   \__ \ / / / // /|_/ // __// / / // __ \ / _ \</span></span>
<span><span class="co">#&gt;  ___/ // /_/ // /  / // /_ / /_/ // / / //  __/</span></span>
<span><span class="co">#&gt; /____//_____//_/  /_/ \__/ \__,_//_/ /_/ \___/  version 1.3.0.9000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To cite this package in publications type: citation("SDMtune").</span></span></code></pre></div>
<p>For a <strong>Maxent</strong> model we can get the variable
importance values from the output of the MaxEnt Java software. These
values are stored in the model object and can be displayed using the
following command:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">default_model</span><span class="op">@</span><span class="va">model</span><span class="op">@</span><span class="va">results</span></span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; ">
<table class="table table table-striped table-hover" style="margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;">
X.Training.samples
</td>
<td style="text-align:right;">
400.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
Regularized.training.gain
</td>
<td style="text-align:right;">
1.0331
</td>
</tr>
<tr>
<td style="text-align:left;">
Unregularized.training.gain
</td>
<td style="text-align:right;">
1.0959
</td>
</tr>
<tr>
<td style="text-align:left;">
Iterations
</td>
<td style="text-align:right;">
500.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
Training.AUC
</td>
<td style="text-align:right;">
0.8728
</td>
</tr>
<tr>
<td style="text-align:left;">
X.Background.points
</td>
<td style="text-align:right;">
5000.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
bio1.contribution
</td>
<td style="text-align:right;">
83.9402
</td>
</tr>
<tr>
<td style="text-align:left;">
bio12.contribution
</td>
<td style="text-align:right;">
1.8103
</td>
</tr>
<tr>
<td style="text-align:left;">
bio16.contribution
</td>
<td style="text-align:right;">
0.3905
</td>
</tr>
<tr>
<td style="text-align:left;">
bio17.contribution
</td>
<td style="text-align:right;">
0.5052
</td>
</tr>
<tr>
<td style="text-align:left;">
bio5.contribution
</td>
<td style="text-align:right;">
0.9666
</td>
</tr>
<tr>
<td style="text-align:left;">
bio6.contribution
</td>
<td style="text-align:right;">
1.3898
</td>
</tr>
<tr>
<td style="text-align:left;">
bio7.contribution
</td>
<td style="text-align:right;">
0.3164
</td>
</tr>
<tr>
<td style="text-align:left;">
bio8.contribution
</td>
<td style="text-align:right;">
9.2951
</td>
</tr>
<tr>
<td style="text-align:left;">
biome.contribution
</td>
<td style="text-align:right;">
1.3858
</td>
</tr>
<tr>
<td style="text-align:left;">
bio1.permutation.importance
</td>
<td style="text-align:right;">
55.4917
</td>
</tr>
<tr>
<td style="text-align:left;">
bio12.permutation.importance
</td>
<td style="text-align:right;">
7.3454
</td>
</tr>
<tr>
<td style="text-align:left;">
bio16.permutation.importance
</td>
<td style="text-align:right;">
0.0200
</td>
</tr>
<tr>
<td style="text-align:left;">
bio17.permutation.importance
</td>
<td style="text-align:right;">
3.0841
</td>
</tr>
<tr>
<td style="text-align:left;">
bio5.permutation.importance
</td>
<td style="text-align:right;">
6.4903
</td>
</tr>
<tr>
<td style="text-align:left;">
bio6.permutation.importance
</td>
<td style="text-align:right;">
1.1164
</td>
</tr>
<tr>
<td style="text-align:left;">
bio7.permutation.importance
</td>
<td style="text-align:right;">
2.9769
</td>
</tr>
<tr>
<td style="text-align:left;">
bio8.permutation.importance
</td>
<td style="text-align:right;">
18.1317
</td>
</tr>
<tr>
<td style="text-align:left;">
biome.permutation.importance
</td>
<td style="text-align:right;">
5.3435
</td>
</tr>
<tr>
<td style="text-align:left;">
Entropy
</td>
<td style="text-align:right;">
7.4862
</td>
</tr>
<tr>
<td style="text-align:left;">
Prevalence..average.probability.of.presence.over.background.sites.
</td>
<td style="text-align:right;">
0.2172
</td>
</tr>
<tr>
<td style="text-align:left;">
Fixed.cumulative.value.1.cumulative.threshold
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
Fixed.cumulative.value.1.Cloglog.threshold
</td>
<td style="text-align:right;">
0.0544
</td>
</tr>
<tr>
<td style="text-align:left;">
Fixed.cumulative.value.1.area
</td>
<td style="text-align:right;">
0.4232
</td>
</tr>
<tr>
<td style="text-align:left;">
Fixed.cumulative.value.1.training.omission
</td>
<td style="text-align:right;">
0.0100
</td>
</tr>
<tr>
<td style="text-align:left;">
Fixed.cumulative.value.5.cumulative.threshold
</td>
<td style="text-align:right;">
5.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
Fixed.cumulative.value.5.Cloglog.threshold
</td>
<td style="text-align:right;">
0.2660
</td>
</tr>
<tr>
<td style="text-align:left;">
Fixed.cumulative.value.5.area
</td>
<td style="text-align:right;">
0.3340
</td>
</tr>
<tr>
<td style="text-align:left;">
Fixed.cumulative.value.5.training.omission
</td>
<td style="text-align:right;">
0.0450
</td>
</tr>
<tr>
<td style="text-align:left;">
Fixed.cumulative.value.10.cumulative.threshold
</td>
<td style="text-align:right;">
10.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
Fixed.cumulative.value.10.Cloglog.threshold
</td>
<td style="text-align:right;">
0.3735
</td>
</tr>
<tr>
<td style="text-align:left;">
Fixed.cumulative.value.10.area
</td>
<td style="text-align:right;">
0.2876
</td>
</tr>
<tr>
<td style="text-align:left;">
Fixed.cumulative.value.10.training.omission
</td>
<td style="text-align:right;">
0.0750
</td>
</tr>
<tr>
<td style="text-align:left;">
Minimum.training.presence.cumulative.threshold
</td>
<td style="text-align:right;">
0.3722
</td>
</tr>
<tr>
<td style="text-align:left;">
Minimum.training.presence.Cloglog.threshold
</td>
<td style="text-align:right;">
0.0150
</td>
</tr>
<tr>
<td style="text-align:left;">
Minimum.training.presence.area
</td>
<td style="text-align:right;">
0.4990
</td>
</tr>
<tr>
<td style="text-align:left;">
Minimum.training.presence.training.omission
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
X10.percentile.training.presence.cumulative.threshold
</td>
<td style="text-align:right;">
11.9719
</td>
</tr>
<tr>
<td style="text-align:left;">
X10.percentile.training.presence.Cloglog.threshold
</td>
<td style="text-align:right;">
0.4072
</td>
</tr>
<tr>
<td style="text-align:left;">
X10.percentile.training.presence.area
</td>
<td style="text-align:right;">
0.2734
</td>
</tr>
<tr>
<td style="text-align:left;">
X10.percentile.training.presence.training.omission
</td>
<td style="text-align:right;">
0.1000
</td>
</tr>
<tr>
<td style="text-align:left;">
Equal.training.sensitivity.and.specificity.cumulative.threshold
</td>
<td style="text-align:right;">
24.7858
</td>
</tr>
<tr>
<td style="text-align:left;">
Equal.training.sensitivity.and.specificity.Cloglog.threshold
</td>
<td style="text-align:right;">
0.5691
</td>
</tr>
<tr>
<td style="text-align:left;">
Equal.training.sensitivity.and.specificity.area
</td>
<td style="text-align:right;">
0.2074
</td>
</tr>
<tr>
<td style="text-align:left;">
Equal.training.sensitivity.and.specificity.training.omission
</td>
<td style="text-align:right;">
0.2075
</td>
</tr>
<tr>
<td style="text-align:left;">
Maximum.training.sensitivity.plus.specificity.cumulative.threshold
</td>
<td style="text-align:right;">
10.9491
</td>
</tr>
<tr>
<td style="text-align:left;">
Maximum.training.sensitivity.plus.specificity.Cloglog.threshold
</td>
<td style="text-align:right;">
0.3900
</td>
</tr>
<tr>
<td style="text-align:left;">
Maximum.training.sensitivity.plus.specificity.area
</td>
<td style="text-align:right;">
0.2806
</td>
</tr>
<tr>
<td style="text-align:left;">
Maximum.training.sensitivity.plus.specificity.training.omission
</td>
<td style="text-align:right;">
0.0775
</td>
</tr>
<tr>
<td style="text-align:left;">
Balance.training.omission..predicted.area.and.threshold.value.cumulative.threshold
</td>
<td style="text-align:right;">
1.4303
</td>
</tr>
<tr>
<td style="text-align:left;">
Balance.training.omission..predicted.area.and.threshold.value.Cloglog.threshold
</td>
<td style="text-align:right;">
0.0864
</td>
</tr>
<tr>
<td style="text-align:left;">
Balance.training.omission..predicted.area.and.threshold.value.area
</td>
<td style="text-align:right;">
0.4016
</td>
</tr>
<tr>
<td style="text-align:left;">
Balance.training.omission..predicted.area.and.threshold.value.training.omission
</td>
<td style="text-align:right;">
0.0100
</td>
</tr>
<tr>
<td style="text-align:left;">
Equate.entropy.of.thresholded.and.original.distributions.cumulative.threshold
</td>
<td style="text-align:right;">
3.3019
</td>
</tr>
<tr>
<td style="text-align:left;">
Equate.entropy.of.thresholded.and.original.distributions.Cloglog.threshold
</td>
<td style="text-align:right;">
0.1993
</td>
</tr>
<tr>
<td style="text-align:left;">
Equate.entropy.of.thresholded.and.original.distributions.area
</td>
<td style="text-align:right;">
0.3566
</td>
</tr>
<tr>
<td style="text-align:left;">
Equate.entropy.of.thresholded.and.original.distributions.training.omission
</td>
<td style="text-align:right;">
0.0300
</td>
</tr>
</tbody></table>
</div>
<p>The function <code><a href="../reference/maxentVarImp.html">maxentVarImp()</a></code> extracts the variable
importance values from the previous output and formats them in a more
human readable way:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/maxentVarImp.html">maxentVarImp</a></span><span class="op">(</span><span class="va">default_model</span><span class="op">)</span></span>
<span><span class="va">vi</span></span></code></pre></div>
<table class="table table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Percent_contribution
</th>
<th style="text-align:right;">
Permutation_importance
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
bio1
</td>
<td style="text-align:right;">
83.9402
</td>
<td style="text-align:right;">
55.4917
</td>
</tr>
<tr>
<td style="text-align:left;">
bio8
</td>
<td style="text-align:right;">
9.2951
</td>
<td style="text-align:right;">
18.1317
</td>
</tr>
<tr>
<td style="text-align:left;">
bio12
</td>
<td style="text-align:right;">
1.8103
</td>
<td style="text-align:right;">
7.3454
</td>
</tr>
<tr>
<td style="text-align:left;">
bio6
</td>
<td style="text-align:right;">
1.3898
</td>
<td style="text-align:right;">
1.1164
</td>
</tr>
<tr>
<td style="text-align:left;">
biome
</td>
<td style="text-align:right;">
1.3858
</td>
<td style="text-align:right;">
5.3435
</td>
</tr>
<tr>
<td style="text-align:left;">
bio5
</td>
<td style="text-align:right;">
0.9666
</td>
<td style="text-align:right;">
6.4903
</td>
</tr>
<tr>
<td style="text-align:left;">
bio17
</td>
<td style="text-align:right;">
0.5052
</td>
<td style="text-align:right;">
3.0841
</td>
</tr>
<tr>
<td style="text-align:left;">
bio16
</td>
<td style="text-align:right;">
0.3905
</td>
<td style="text-align:right;">
0.0200
</td>
</tr>
<tr>
<td style="text-align:left;">
bio7
</td>
<td style="text-align:right;">
0.3164
</td>
<td style="text-align:right;">
2.9769
</td>
</tr>
</tbody>
</table>
<p>As you can see the function returns a <code>data.frame</code> with
the variable name, the percent contribution and the permutation
importance.</p>
<p>You can plot the variable importance as a bar chart using the
function <code><a href="../reference/plotVarImp.html">plotVarImp()</a></code>. For example you can plot the percent
contribution using:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotVarImp.html">plotVarImp</a></span><span class="op">(</span><span class="va">vi</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="variable-importance_files/figure-html/maxent-percent-contribution-plot-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="try-yourself">Try yourself<a class="anchor" aria-label="anchor" href="#try-yourself"></a>
</h3>
<p>Plot the permutation importance as a bar chart. To see the solution
highlight the following cell:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The function accepts a data.frame with 2 columns: one with the variable name</span></span>
<span><span class="co"># and one with the values, so it is enough to select the first and the third</span></span>
<span><span class="co"># columns from the vi data.frame</span></span>
<span><span class="fu"><a href="../reference/plotVarImp.html">plotVarImp</a></span><span class="op">(</span><span class="va">vi</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><strong>SDMtune</strong> has its own function to compute the
permutation importance that iterates through several permutations and
return an averaged value together with the standard deviation. We will
use this function to compute the permutation importance of a
<strong>Maxnet</strong> model.</p>
</div>
</div>
<div class="section level2">
<h2 id="permutation-importance">Permutation importance<a class="anchor" aria-label="anchor" href="#permutation-importance"></a>
</h2>
<p>For this example we use a <strong>Maxnet</strong> model and a
training/testing validation strategy like in the <a href="./evaluation-strategies.html#train-and-testing-datasets">previous
article</a>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nteetor/zeallot" class="external-link">zeallot</a></span><span class="op">)</span>  <span class="co"># For unpacking assignment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">train</span>, <span class="va">test</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/zeallot/man/operator.html" class="external-link">%&lt;-%</a></span> <span class="fu"><a href="../reference/trainValTest.html">trainValTest</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>                                 test <span class="op">=</span> <span class="fl">0.2</span>, </span>
<span>                                 only_presence <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                 seed <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="va">maxnet_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/train.html">train</a></span><span class="op">(</span><span class="st">"Maxnet"</span>, </span>
<span>                      data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span></code></pre></div>
<p>Now we can calculate the variable importance with the function
<code><a href="../reference/varImp.html">varImp()</a></code> using 5 permutations:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vi_maxnet</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/varImp.html">varImp</a></span><span class="op">(</span><span class="va">maxnet_model</span>, </span>
<span>                    permut <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">vi_maxnet</span></span></code></pre></div>
<table class="table table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Permutation_importance
</th>
<th style="text-align:right;">
sd
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
bio1
</td>
<td style="text-align:right;">
55.4
</td>
<td style="text-align:right;">
0.015
</td>
</tr>
<tr>
<td style="text-align:left;">
bio8
</td>
<td style="text-align:right;">
20.4
</td>
<td style="text-align:right;">
0.007
</td>
</tr>
<tr>
<td style="text-align:left;">
biome
</td>
<td style="text-align:right;">
5.7
</td>
<td style="text-align:right;">
0.002
</td>
</tr>
<tr>
<td style="text-align:left;">
bio17
</td>
<td style="text-align:right;">
5.2
</td>
<td style="text-align:right;">
0.003
</td>
</tr>
<tr>
<td style="text-align:left;">
bio5
</td>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:right;">
0.003
</td>
</tr>
<tr>
<td style="text-align:left;">
bio7
</td>
<td style="text-align:right;">
3.4
</td>
<td style="text-align:right;">
0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
bio16
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
0.002
</td>
</tr>
<tr>
<td style="text-align:left;">
bio12
</td>
<td style="text-align:right;">
1.8
</td>
<td style="text-align:right;">
0.002
</td>
</tr>
<tr>
<td style="text-align:left;">
bio6
</td>
<td style="text-align:right;">
1.2
</td>
<td style="text-align:right;">
0.001
</td>
</tr>
</tbody>
</table>
<p>And plot it with:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotVarImp.html">plotVarImp</a></span><span class="op">(</span><span class="va">vi_maxnet</span><span class="op">)</span></span></code></pre></div>
<p><img src="variable-importance_files/figure-html/plot-var-imp-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="try-yourself-1">Try yourself<a class="anchor" aria-label="anchor" href="#try-yourself-1"></a>
</h3>
<p>Use the <code><a href="../reference/varImp.html">varImp()</a></code> function to compute the permutation
importance for the <code>default_model</code> using 10 permutations and
compare the results with the Maxent output. To see the solution
highlight the following cell:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute the permutation importance</span></span>
<span><span class="va">vi_maxent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/varImp.html">varImp</a></span><span class="op">(</span><span class="va">default_model</span>, </span>
<span>                    permut <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print it</span></span>
<span><span class="va">vi_maxent</span></span>
<span></span>
<span><span class="co"># Compare with Maxent output</span></span>
<span><span class="fu"><a href="../reference/maxentVarImp.html">maxentVarImp</a></span><span class="op">(</span><span class="va">default_model</span><span class="op">)</span></span></code></pre></div>
<p>The difference is probably due to a different shuffling of the
presence and background locations during the permutation process and
because in this example we performed 10 permutations and averaged the
values.</p>
</div>
</div>
<div class="section level2">
<h2 id="jackknife-test-for-variable-importance">Jackknife test for variable importance<a class="anchor" aria-label="anchor" href="#jackknife-test-for-variable-importance"></a>
</h2>
<p>Another method to estimate the variable importance is the leave one
out Jackknife test. The test removes one variable at time and records
the change in the chosen metric. We use the function
<code><a href="../reference/doJk.html">doJk()</a></code>, the AUC as evaluation metric and the
<code>maxnet_model</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/doJk.html">doJk</a></span><span class="op">(</span><span class="va">maxnet_model</span>, </span>
<span>           metric <span class="op">=</span> <span class="st">"auc"</span>, </span>
<span>           test <span class="op">=</span> <span class="va">test</span><span class="op">)</span></span>
<span><span class="va">jk</span></span></code></pre></div>
<table class="table table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Train_AUC_without
</th>
<th style="text-align:right;">
Train_AUC_withonly
</th>
<th style="text-align:right;">
Test_AUC_without
</th>
<th style="text-align:right;">
Test_AUC_withonly
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
bio1
</td>
<td style="text-align:right;">
0.8697906
</td>
<td style="text-align:right;">
0.8470397
</td>
<td style="text-align:right;">
0.8477113
</td>
<td style="text-align:right;">
0.8451538
</td>
</tr>
<tr>
<td style="text-align:left;">
bio12
</td>
<td style="text-align:right;">
0.8748544
</td>
<td style="text-align:right;">
0.7383734
</td>
<td style="text-align:right;">
0.8500262
</td>
<td style="text-align:right;">
0.7497700
</td>
</tr>
<tr>
<td style="text-align:left;">
bio16
</td>
<td style="text-align:right;">
0.8749850
</td>
<td style="text-align:right;">
0.7435100
</td>
<td style="text-align:right;">
0.8510863
</td>
<td style="text-align:right;">
0.7795350
</td>
</tr>
<tr>
<td style="text-align:left;">
bio17
</td>
<td style="text-align:right;">
0.8748731
</td>
<td style="text-align:right;">
0.6149309
</td>
<td style="text-align:right;">
0.8491062
</td>
<td style="text-align:right;">
0.5770612
</td>
</tr>
<tr>
<td style="text-align:left;">
bio5
</td>
<td style="text-align:right;">
0.8752431
</td>
<td style="text-align:right;">
0.7307531
</td>
<td style="text-align:right;">
0.8518762
</td>
<td style="text-align:right;">
0.7067212
</td>
</tr>
<tr>
<td style="text-align:left;">
bio6
</td>
<td style="text-align:right;">
0.8743531
</td>
<td style="text-align:right;">
0.8195153
</td>
<td style="text-align:right;">
0.8509362
</td>
<td style="text-align:right;">
0.8325700
</td>
</tr>
<tr>
<td style="text-align:left;">
bio7
</td>
<td style="text-align:right;">
0.8741562
</td>
<td style="text-align:right;">
0.7271819
</td>
<td style="text-align:right;">
0.8488388
</td>
<td style="text-align:right;">
0.7420450
</td>
</tr>
<tr>
<td style="text-align:left;">
bio8
</td>
<td style="text-align:right;">
0.8668319
</td>
<td style="text-align:right;">
0.8319653
</td>
<td style="text-align:right;">
0.8480237
</td>
<td style="text-align:right;">
0.8246163
</td>
</tr>
<tr>
<td style="text-align:left;">
biome
</td>
<td style="text-align:right;">
0.8705269
</td>
<td style="text-align:right;">
0.7874897
</td>
<td style="text-align:right;">
0.8481788
</td>
<td style="text-align:right;">
0.7857500
</td>
</tr>
</tbody>
</table>
<p>We can also plot the output using the function <code><a href="../reference/plotJk.html">plotJk()</a></code>.
In the following example we plot the previous result and we add a line
representing the AUC of the full model trained using all the variables.
First we plot the Jackknife test for the training AUC:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotJk.html">plotJk</a></span><span class="op">(</span><span class="va">jk</span>, </span>
<span>       type <span class="op">=</span> <span class="st">"train"</span>, </span>
<span>       ref <span class="op">=</span> <span class="fu"><a href="../reference/auc.html">auc</a></span><span class="op">(</span><span class="va">maxnet_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="variable-importance_files/figure-html/plot-jk-train-1.png" width="700" style="display: block; margin: auto;"></p>
<p>and the Jackknife test for the testing AUC:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotJk.html">plotJk</a></span><span class="op">(</span><span class="va">jk</span>, </span>
<span>       type <span class="op">=</span> <span class="st">"test"</span>, </span>
<span>       ref <span class="op">=</span> <span class="fu"><a href="../reference/auc.html">auc</a></span><span class="op">(</span><span class="va">maxnet_model</span>, test <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="variable-importance_files/figure-html/plot-jk-test-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="try-yourself-2">Try yourself<a class="anchor" aria-label="anchor" href="#try-yourself-2"></a>
</h3>
<p>Repeat the Jackknife part using the TSS and the AICc as evaluation
metric and using the <code>dafult_model</code></p>
</div>
</div>
<div class="section level2">
<h2 id="response-curves">Response curves<a class="anchor" aria-label="anchor" href="#response-curves"></a>
</h2>
<p>With the function <code><a href="../reference/plotResponse.html">plotResponse()</a></code> is possible to plot the
marginal and the univariate response curve. Let’s plot the
<strong>cloglog</strong> univariate response curve of
<strong>bio1</strong>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotResponse.html">plotResponse</a></span><span class="op">(</span><span class="va">maxnet_model</span>, </span>
<span>             var <span class="op">=</span> <span class="st">"bio1"</span>, </span>
<span>             type <span class="op">=</span> <span class="st">"cloglog"</span>, </span>
<span>             only_presence <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>             marginal <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>             rug <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="variable-importance_files/figure-html/plot-bio1-1.png" width="700" style="display: block; margin: auto;"></p>
<p>On top is displayed the rug of the presence locations and on bottom
the rug of the background locations. As another example we can plot the
<strong>logistic</strong> marginal response curve of
<strong>biome</strong> that is a categorical variable, keeping the other
variables at the mean value:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotResponse.html">plotResponse</a></span><span class="op">(</span><span class="va">maxnet_model</span>, </span>
<span>             var <span class="op">=</span> <span class="st">"biome"</span>, </span>
<span>             type <span class="op">=</span> <span class="st">"logistic"</span>, </span>
<span>             only_presence <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>             marginal <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>             fun <span class="op">=</span> <span class="va">mean</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="variable-importance_files/figure-html/plot-biome-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="try-yourself-3">Try yourself<a class="anchor" aria-label="anchor" href="#try-yourself-3"></a>
</h3>
<p>Plot in green the univariate cloglog response curve of
<strong>bio17</strong> removing the rug and using the
<code>default_model</code>, to see the solution highlight the following
cell:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotResponse.html">plotResponse</a></span><span class="op">(</span><span class="va">default_model</span>, </span>
<span>             var <span class="op">=</span> <span class="st">"bio17"</span>, </span>
<span>             type <span class="op">=</span> <span class="st">"cloglog"</span>, </span>
<span>             only_presence <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>             marginal <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span></span></code></pre></div>
<p>In the case of an <code><a href="../reference/SDMmodelCV-class.html">SDMmodelCV()</a></code> the response curve shows
the averaged value of the prediction together with one Standard
Deviation error interval. We use the cross validation model trained in
the <a href="./evaluation-strategies.html#cross-validation">previous
article</a>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotResponse.html">plotResponse</a></span><span class="op">(</span><span class="va">cv_model</span>, </span>
<span>             var <span class="op">=</span> <span class="st">"bio1"</span>, </span>
<span>             type <span class="op">=</span> <span class="st">"cloglog"</span>, </span>
<span>             only_presence <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>             marginal <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>             fun <span class="op">=</span> <span class="va">mean</span>, </span>
<span>             rug <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="variable-importance_files/figure-html/plot-cv-response-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="model-report">Model report<a class="anchor" aria-label="anchor" href="#model-report"></a>
</h2>
<p>All what you have learned till now con be saved and summarized
calling the function <code><a href="../reference/modelReport.html">modelReport()</a></code>. The function will:</p>
<ul>
<li>save the training, background and testing locations in separated csv
files;</li>
<li>train and evaluate the model;</li>
<li>create a report in a html format with the ROC curve, threshold
values, response curves, predicted map and Jackknife test;</li>
<li>save the predicted distribution map;</li>
<li>save all the curves in the plot folder;</li>
<li>save the model with <code>.Rds</code> extension that can be loaded
in R using the <code>readRDS</code> function.</li>
</ul>
<p>The function is totally inspired by the default output of the MaxEnt
Java software <span class="citation">[@Phillips2006]</span> and extends
it to other methods. You can decide what to include in the report using
dedicated function arguments, like <code>response_curves</code>,
<code>jk</code> and <code>env</code> but the function cannot be used
with <code><a href="../reference/SDMmodelCV-class.html">SDMmodelCV()</a></code> objects. Run the following code to create
a report of the <strong>Maxnet</strong> model we trained before:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/modelReport.html">modelReport</a></span><span class="op">(</span><span class="va">maxnet_model</span>, </span>
<span>            type <span class="op">=</span> <span class="st">"cloglog"</span>, </span>
<span>            folder <span class="op">=</span> <span class="st">"virtual-sp"</span>, </span>
<span>            test <span class="op">=</span> <span class="va">test</span>, </span>
<span>            response_curves <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>            only_presence <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>            jk <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>            env <span class="op">=</span> <span class="va">predictors</span><span class="op">)</span></span></code></pre></div>
<p>The output is displayed in the browser and all the files are saved in
the <strong>virtual-sp</strong> folder.</p>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>In this article you have learned:</p>
<ul>
<li>how to get and plot the variable importance for
<strong>Maxent</strong> models;</li>
<li>how to compute and plot the permutation importance;</li>
<li>how to perform the leave one out Jackknife test;</li>
<li>how to plot the marginal and the univariate response curve;</li>
<li>how to create a model report.</li>
</ul>
<p>In the <a href="./variable-selection.html">next article</a> you will
learn how to perform data-driven variable selection.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/sgvignali" class="external-link">Sergio Vignali</a>, <a href="http://www.cb.iee.unibe.ch/about_us/barras_arnaud_gian/index_eng.html" class="external-link">Arnaud Barras</a>, <a href="http://www.cb.iee.unibe.ch/about_us/dr_braunisch_veronika/index_eng.html" class="external-link">Veronika Braunisch</a>, <a href="http://www.cb.iee.unibe.ch/index_eng.html" class="external-link">Conservation Biology - University of Bern</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
