<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SDMtune">
<title>Evaluation strategies • SDMtune</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Evaluation strategies">
<meta property="og:description" content="SDMtune">
<meta property="og:image" content="https://consbiol-unibern.github.io/SDMtune/logo.png">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SDMtune</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.3.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/articles/prepare-data.html">Prepare data for the analysis</a>
    <a class="dropdown-item" href="../articles/articles/train-model.html">Train a model</a>
    <a class="dropdown-item" href="../articles/articles/make-predictions.html">Make predictions</a>
    <a class="dropdown-item" href="../articles/articles/evaluate-model.html">Evaluate a model</a>
    <a class="dropdown-item" href="../articles/articles/evaluation-strategies.html">Evaluation strategies</a>
    <a class="dropdown-item" href="../articles/articles/variable-importance.html">Variable importance</a>
    <a class="dropdown-item" href="../articles/articles/variable-selection.html">Data-driven variable selection</a>
    <a class="dropdown-item" href="../articles/articles/tune-hyperparameters.html">Tune model hyperparameters</a>
    <a class="dropdown-item" href="../articles/articles/train-tune-presence-absence-models.html">Train and tune presence absence models</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ConsBiol-unibern/SDMtune">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="evaluation-strategies_files/kePrint-0.0.1/kePrint.js"></script><link href="evaluation-strategies_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Evaluation strategies</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ConsBiol-unibern/SDMtune/blob/HEAD/vignettes/articles/evaluation-strategies.Rmd" class="external-link"><code>vignettes/articles/evaluation-strategies.Rmd</code></a></small>
      <div class="d-none name"><code>evaluation-strategies.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="intro">Intro<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<p>In the previous articles you have learned how to <a href="./prepare-data.html">prepare the data</a> for the analysis, how to
<a href="./train-model.html">train a model</a>, how to <a href="./make-predictions.html">make predictions</a> and how to <a href="./evaluate-model.html">evaluate a model</a> using
<strong>SDMtune</strong>. In this article you will learn different
evaluation strategies to achieve a better estimate of the model
performance.</p>
</div>
<div class="section level2">
<h2 id="training-and-testing-datasets">Training and testing datasets<a class="anchor" aria-label="anchor" href="#training-and-testing-datasets"></a>
</h2>
<p>First we load the <strong>SDMtune</strong> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://consbiol-unibern.github.io/SDMtune/">SDMtune</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    _____  ____   __  ___ __</span></span>
<span><span class="co">#&gt;   / ___/ / __ \ /  |/  // /_ __  __ ____   ___</span></span>
<span><span class="co">#&gt;   \__ \ / / / // /|_/ // __// / / // __ \ / _ \</span></span>
<span><span class="co">#&gt;  ___/ // /_/ // /  / // /_ / /_/ // / / //  __/</span></span>
<span><span class="co">#&gt; /____//_____//_/  /_/ \__/ \__,_//_/ /_/ \___/  version 1.3.0.9000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To cite this package in publications type: citation("SDMtune").</span></span></code></pre></div>
<p>It’s always a good practice to split the species locations into two
parts and use one part to train the model and the remaining part to
evaluate it. We can use the <code><a href="../reference/trainValTest.html">trainValTest()</a></code> function for
this purpose. Let’s say we want to use 80% of the species locations to
train our model and 20% as testing dataset to evaluate it:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nteetor/zeallot" class="external-link">zeallot</a></span><span class="op">)</span>  <span class="co"># For unpacking assignment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">train</span>, <span class="va">test</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/zeallot/man/operator.html" class="external-link">%&lt;-%</a></span> <span class="fu"><a href="../reference/trainValTest.html">trainValTest</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>                                 test <span class="op">=</span> <span class="fl">0.2</span>, </span>
<span>                                 only_presence <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                 seed <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="va">maxnet_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/train.html">train</a></span><span class="op">(</span><span class="st">"Maxnet"</span>, </span>
<span>                      data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span></code></pre></div>
<p>The <code>only_presence</code> argument is used to split only the
presence and not the background locations. We can now evaluate the model
using the testing dataset that has not been used to train the model:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Training auc: "</span>, <span class="fu"><a href="../reference/auc.html">auc</a></span><span class="op">(</span><span class="va">maxnet_model</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Training auc:  0.8752144</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Testing auc: "</span>, <span class="fu"><a href="../reference/auc.html">auc</a></span><span class="op">(</span><span class="va">maxnet_model</span>, test <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Testing auc:  0.8505888</span></span></code></pre></div>
<p>We can plot the ROC curve for both, training and testing datasets,
with:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotROC.html">plotROC</a></span><span class="op">(</span><span class="va">maxnet_model</span>, </span>
<span>        test <span class="op">=</span> <span class="va">test</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The following aesthetics were dropped during statistical transformation: <span style="color: #00BB00;">m, d</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> This can happen when ggplot fails to infer the correct grouping structure in</span></span>
<span><span class="co">#&gt;   the data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Did you forget to specify a `group` aesthetic or to convert a numerical</span></span>
<span><span class="co">#&gt;   variable into a factor?</span></span></code></pre></div>
<p><img src="evaluation-strategies_files/figure-html/plot-AUC-train-test-1.png" width="700" style="display: block; margin: auto;"></p>
<p>This approach is valid when we have a large dataset. In our case,
with only 320 observations, the evaluation depends strongly on how we
split our presence locations. Let’s run a small experiment in which we
perform different train/test splits and we compute the AUC:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fl">10</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="co"># Create an empty data.frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"seed"</span>, <span class="st">"trainAUC"</span>, <span class="st">"testAUC"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span></span>
<span><span class="va">seeds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">10</span><span class="op">)</span> <span class="co"># Create 10 different random seeds</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">seeds</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="co"># Loop through the seeds</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">train</span>, <span class="va">test</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/zeallot/man/operator.html" class="external-link">%&lt;-%</a></span> <span class="fu"><a href="../reference/trainValTest.html">trainValTest</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>                                   test <span class="op">=</span> <span class="fl">0.2</span>, </span>
<span>                                   seed <span class="op">=</span> <span class="va">seeds</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, </span>
<span>                                   only_presence <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Make the train/test split</span></span>
<span>  </span>
<span>  <span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/train.html">train</a></span><span class="op">(</span><span class="st">"Maxnet"</span>, </span>
<span>             data <span class="op">=</span> <span class="va">train</span><span class="op">)</span> <span class="co"># train the model</span></span>
<span>  </span>
<span>  <span class="co"># Populate the output data.frame</span></span>
<span>  <span class="va">output</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">seeds</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">output</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auc.html">auc</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span>  <span class="va">output</span><span class="op">[</span><span class="va">i</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auc.html">auc</a></span><span class="op">(</span><span class="va">m</span>, test <span class="op">=</span> <span class="va">test</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The testing AUC varies from 0.834 to 0.867.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print the output</span></span>
<span><span class="va">output</span></span></code></pre></div>
<table class="table table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;">
seed
</th>
<th style="text-align:right;">
trainAUC
</th>
<th style="text-align:right;">
testAUC
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
647
</td>
<td style="text-align:right;">
0.8698272
</td>
<td style="text-align:right;">
0.8552425
</td>
</tr>
<tr>
<td style="text-align:right;">
477
</td>
<td style="text-align:right;">
0.8782434
</td>
<td style="text-align:right;">
0.8340675
</td>
</tr>
<tr>
<td style="text-align:right;">
536
</td>
<td style="text-align:right;">
0.8680666
</td>
<td style="text-align:right;">
0.8656850
</td>
</tr>
<tr>
<td style="text-align:right;">
444
</td>
<td style="text-align:right;">
0.8735606
</td>
<td style="text-align:right;">
0.8566337
</td>
</tr>
<tr>
<td style="text-align:right;">
985
</td>
<td style="text-align:right;">
0.8712828
</td>
<td style="text-align:right;">
0.8565025
</td>
</tr>
<tr>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
0.8719091
</td>
<td style="text-align:right;">
0.8519175
</td>
</tr>
<tr>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
0.8719313
</td>
<td style="text-align:right;">
0.8661387
</td>
</tr>
<tr>
<td style="text-align:right;">
617
</td>
<td style="text-align:right;">
0.8743353
</td>
<td style="text-align:right;">
0.8529850
</td>
</tr>
<tr>
<td style="text-align:right;">
282
</td>
<td style="text-align:right;">
0.8695072
</td>
<td style="text-align:right;">
0.8671275
</td>
</tr>
<tr>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
0.8709719
</td>
<td style="text-align:right;">
0.8671762
</td>
</tr>
</tbody>
</table>
<p>When we have to deal with a small dataset a better approach is the
cross validation.</p>
</div>
<div class="section level2">
<h2 id="cross-validation">Cross validation<a class="anchor" aria-label="anchor" href="#cross-validation"></a>
</h2>
<p>To perform a cross validation in <strong>SDMtune</strong> we have to
pass the <code>fold</code> argument to the <code><a href="../reference/train.html">train()</a></code>
function. First we have to create the folds. There are several way to
create them, here we explain how to make a random partition of 4 folds
using the function <code><a href="../reference/randomFolds.html">randomFolds()</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">folds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/randomFolds.html">randomFolds</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>                     k <span class="op">=</span> <span class="fl">4</span>, </span>
<span>                     only_presence <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                     seed <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></code></pre></div>
<p>The output of the function is a list containing two matrices, the
first for the training and the second for the testing locations. Each
column of one matrix represents a fold with <code>TRUE</code> for the
locations included in and <code>FALSE</code> excluded from the
partition.</p>
<p>Let’s perform a 4 fold cross validation using the
<strong>Maxnet</strong> method (note that we use the full dataset):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/train.html">train</a></span><span class="op">(</span><span class="st">"Maxnet"</span>, </span>
<span>                  data <span class="op">=</span> <span class="va">data</span>, </span>
<span>                  folds <span class="op">=</span> <span class="va">folds</span><span class="op">)</span></span>
<span><span class="va">cv_model</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Object of class: </span><span style="color: #0000BB; font-weight: bold;">&lt;SDMmodelCV&gt;</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: <span style="font-style: italic;">Maxnet</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Hyperparameters</span></span>
<span><span class="co">#&gt; • <span style="color: #00BB00;">fc</span>: <span style="color: #0000BB;">"lqph"</span></span></span>
<span><span class="co">#&gt; • <span style="color: #00BB00;">reg</span>: <span style="color: #0000BB;">1</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Info</span></span>
<span><span class="co">#&gt; • <span style="color: #00BB00;">Species</span>: <span style="font-style: italic;">Virtual species</span></span></span>
<span><span class="co">#&gt; • <span style="color: #00BB00;">Replicates</span>: <span style="color: #0000BB;">4</span></span></span>
<span><span class="co">#&gt; • <span style="color: #00BB00;">Total presence locations</span>: <span style="color: #0000BB;">400</span></span></span>
<span><span class="co">#&gt; • <span style="color: #00BB00;">Total absence locations</span>: <span style="color: #0000BB;">5000</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Variables</span></span>
<span><span class="co">#&gt; • <span style="color: #00BB00;">Continuous</span>: <span style="color: #0000BB;">"bio1"</span>, <span style="color: #0000BB;">"bio12"</span>, <span style="color: #0000BB;">"bio16"</span>, <span style="color: #0000BB;">"bio17"</span>, <span style="color: #0000BB;">"bio5"</span>, <span style="color: #0000BB;">"bio6"</span>, <span style="color: #0000BB;">"bio7"</span>, and</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">"bio8"</span></span></span>
<span><span class="co">#&gt; • <span style="color: #00BB00;">Categorical</span>: <span style="color: #0000BB;">"biome"</span></span></span></code></pre>
<p>The output in this case is an <code><a href="../reference/SDMmodelCV-class.html">SDMmodelCV()</a></code> object. It
contains the four trained models in the <code>models</code> slot and the
fold partitions in the <code>folds</code> slot. We can compute the AUC
of a <code><a href="../reference/SDMmodelCV-class.html">SDMmodelCV()</a></code> object using:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Training AUC: "</span>, <span class="fu"><a href="../reference/auc.html">auc</a></span><span class="op">(</span><span class="va">cv_model</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Training AUC:  0.8734151</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Testing AUC: "</span>, <span class="fu"><a href="../reference/auc.html">auc</a></span><span class="op">(</span><span class="va">cv_model</span>, test <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Testing AUC:  0.8553538</span></span></code></pre></div>
<p>this returns the AUC value averaged across the four different
models.</p>
<div class="section level3">
<h3 id="try-yourself">Try yourself<a class="anchor" aria-label="anchor" href="#try-yourself"></a>
</h3>
<p>Repeat the analysis using the <code>default_model</code> that we
created in the <a href="./model-training.html#train-a-model-with-default-settings">train a
model</a> article.</p>
</div>
<div class="section level3">
<h3 id="spatial-cross-validation">Spatial Cross Validation<a class="anchor" aria-label="anchor" href="#spatial-cross-validation"></a>
</h3>
<p>The <code><a href="../reference/train.html">train()</a></code> function accepts folds created with two
other packages:</p>
<ul>
<li>
<code>ENMeval</code> <span class="citation">(Muscarella et al.
2014)</span>
</li>
<li>
<code>blockCV</code> <span class="citation">(Valavi et al.
2019)</span>
</li>
</ul>
<p>The function will convert internally the created folds into the
correct format for <code>SDMtune</code>. These packages have specific
function to create folds partitions that are spatially or
environmentally independent.</p>
<p>Block partition using the package <code>ENMeval</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jamiemkass.github.io/ENMeval/" class="external-link">ENMeval</a></span><span class="op">)</span></span>
<span><span class="va">block_folds</span> <span class="op">&lt;-</span> <span class="fu">get.block</span><span class="op">(</span>occ <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">coords</span><span class="op">[</span><span class="va">data</span><span class="op">@</span><span class="va">pa</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span>, </span>
<span>                         bg.coords <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">coords</span><span class="op">[</span><span class="va">data</span><span class="op">@</span><span class="va">pa</span> <span class="op">==</span> <span class="fl">0</span>, <span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/train.html">train</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"Maxnet"</span>, </span>
<span>               data <span class="op">=</span> <span class="va">data</span>, </span>
<span>               fc <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>               reg <span class="op">=</span> <span class="fl">0.8</span>, </span>
<span>               folds <span class="op">=</span> <span class="va">block_folds</span><span class="op">)</span></span></code></pre></div>
<p>Checkerboard1 partition using the package <code>ENMeval</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cb_folds</span> <span class="op">&lt;-</span> <span class="fu">get.checkerboard1</span><span class="op">(</span>occ <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">coords</span><span class="op">[</span><span class="va">data</span><span class="op">@</span><span class="va">pa</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span>, </span>
<span>                              env <span class="op">=</span> <span class="va">predictors</span>, </span>
<span>                              bg.coords <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">coords</span><span class="op">[</span><span class="va">data</span><span class="op">@</span><span class="va">pa</span> <span class="op">==</span> <span class="fl">0</span>, <span class="op">]</span>, </span>
<span>                              aggregation.factor <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/train.html">train</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"Maxnet"</span>, </span>
<span>               data <span class="op">=</span> <span class="va">data</span>, </span>
<span>               fc <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>               reg <span class="op">=</span> <span class="fl">0.8</span>, </span>
<span>               folds <span class="op">=</span> <span class="va">cb_folds</span><span class="op">)</span></span></code></pre></div>
<p>Environmental block using the package <code>blockCV</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rvalavi/blockCV" class="external-link">blockCV</a></span><span class="op">)</span></span>
<span><span class="co"># Create sf object</span></span>
<span><span class="va">sf_df</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu">st_as_sf</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">data</span><span class="op">@</span><span class="va">coords</span>, pa <span class="op">=</span> <span class="va">data</span><span class="op">@</span><span class="va">pa</span><span class="op">)</span>,</span>
<span>                      coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"Y"</span><span class="op">)</span>,</span>
<span>                      crs <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">predictors</span>,</span>
<span>                                       proj <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Spatial blocks</span></span>
<span><span class="va">spatial_folds</span> <span class="op">&lt;-</span> <span class="fu">cv_spatial</span><span class="op">(</span>x <span class="op">=</span> <span class="va">sf_df</span>,</span>
<span>                            column <span class="op">=</span> <span class="st">"pa"</span>,</span>
<span>                            rows_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>                            k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                            hexagon <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                            selection <span class="op">=</span> <span class="st">"systematic"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/train.html">train</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"Maxent"</span>, </span>
<span>               data <span class="op">=</span> <span class="va">data</span>, </span>
<span>               fc <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>               reg <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>               folds <span class="op">=</span> <span class="va">spatial_folds</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>In this article you have learned:</p>
<ul>
<li>how to split the presence dataset in training and testing
folds;</li>
<li>how to evaluate the model using the held out testing dataset;</li>
<li>how to create random folds for cross validation;</li>
<li>how to perform a cross validation;</li>
<li>how to use other packages to create the folds for the k-fold cross
validation;</li>
<li>how to evaluate an <code><a href="../reference/SDMmodelCV-class.html">SDMmodelCV()</a></code> object.</li>
</ul>
<p>In the <a href="./variable-importance.html">next article</a> you will
learn how to display the variable importance and how to plot the
response curve.</p>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Muscarella2014" class="csl-entry">
Muscarella, Robert, Peter J. Galante, Mariano Soley-Guardia, Robert A.
Boria, Jamie M. Kass, María Uriarte, and Robert P. Anderson. 2014.
<span>“ENMeval: An r Package for Conducting Spatially Independent
Evaluations and Estimating Optimal Model Complexity for Maxent
Ecological Niche Models.”</span> <em>Methods in Ecology and
Evolution</em> 5 (11): 1198–1205. https://doi.org/<a href="https://doi.org/10.1111/2041-210X.12261" class="external-link">https://doi.org/10.1111/2041-210X.12261</a>.
</div>
<div id="ref-Valavi2019" class="csl-entry">
Valavi, Roozbeh, Jane Elith, José J. Lahoz-Monfort, and Gurutzeta
Guillera-Arroita. 2019. <span>“blockCV: An r Package for Generating
Spatially or Environmentally Separated Folds for k-Fold Cross-Validation
of Species Distribution Models.”</span> <em>Methods in Ecology and
Evolution</em> 10 (2): 225–32. https://doi.org/<a href="https://doi.org/10.1111/2041-210X.13107" class="external-link">https://doi.org/10.1111/2041-210X.13107</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/sgvignali" class="external-link">Sergio Vignali</a>, <a href="http://www.cb.iee.unibe.ch/about_us/barras_arnaud_gian/index_eng.html" class="external-link">Arnaud Barras</a>, <a href="http://www.cb.iee.unibe.ch/about_us/dr_braunisch_veronika/index_eng.html" class="external-link">Veronika Braunisch</a>, <a href="http://www.cb.iee.unibe.ch/index_eng.html" class="external-link">Conservation Biology - University of Bern</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
