<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Variable Selection — varSel • SDMtune</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>


  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Variable Selection — varSel" />
<meta property="og:description" content="The function performs a data-driven variable selection. Starting from the
provided model it iterates through all the variables starting from the one
with the highest contribution (permutation importance or maxent percent
contribution). If the variable is correlated with other variables (according
to the given method and threshold) it performs a Jackknife test and among the
correlated variables it removes the one that results in the best performing
model when removed (according to the given metric for the training dataset).
The process is repeated until the remaining variables are not highly
correlated anymore." />
<meta property="og:image" content="https://consbiol-unibern.github.io/SDMtune/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SDMtune</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/articles/prepare-data.html">Prepare data for the analysis</a>
    </li>
    <li>
      <a href="../articles/articles/train-model.html">Train a model</a>
    </li>
    <li>
      <a href="../articles/articles/make-predictions.html">Make predictions</a>
    </li>
    <li>
      <a href="../articles/articles/evaluate-model.html">Evaluate a model</a>
    </li>
    <li>
      <a href="../articles/articles/evaluation-strategies.html">Evaluation strategies</a>
    </li>
    <li>
      <a href="../articles/articles/variable-importance.html">Variable importance</a>
    </li>
    <li>
      <a href="../articles/articles/variable-selection.html">Data-driven variable selection</a>
    </li>
    <li>
      <a href="../articles/articles/tune-hyperparameters.html">Tune model hyperparameters</a>
    </li>
    <li>
      <a href="../articles/articles/train-tune-presence-absence-models.html">Train and tune presence absence models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ConsBiol-unibern/SDMtune">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Variable Selection</h1>
    <small class="dont-index">Source: <a href='https://github.com/ConsBiol-unibern/SDMtune/blob/master/R/varSel.R'><code>R/varSel.R</code></a></small>
    <div class="hidden name"><code>varSel.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function performs a data-driven variable selection. Starting from the
provided model it iterates through all the variables starting from the one
with the highest contribution (permutation importance or maxent percent
contribution). If the variable is correlated with other variables (according
to the given method and threshold) it performs a Jackknife test and among the
correlated variables it removes the one that results in the best performing
model when removed (according to the given metric for the training dataset).
The process is repeated until the remaining variables are not highly
correlated anymore.</p>
    </div>

    <pre class="usage"><span class='fu'>varSel</span>(
  <span class='no'>model</span>,
  <span class='no'>metric</span>,
  <span class='no'>bg4cor</span>,
  <span class='kw'>test</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>env</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"spearman"</span>,
  <span class='kw'>cor_th</span> <span class='kw'>=</span> <span class='fl'>0.7</span>,
  <span class='kw'>permut</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>use_pc</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>model</th>
      <td><p><a href='SDMmodel-class.html'>SDMmodel</a> or <a href='SDMmodelCV-class.html'>SDMmodelCV</a> object.</p></td>
    </tr>
    <tr>
      <th>metric</th>
      <td><p>character. The metric used to evaluate the models, possible
values are: "auc", "tss" and "aicc".</p></td>
    </tr>
    <tr>
      <th>bg4cor</th>
      <td><p><a href='SWD-class.html'>SWD</a> object. Background locations used to test the
correlation between environmental variables.</p></td>
    </tr>
    <tr>
      <th>test</th>
      <td><p><a href='SWD-class.html'>SWD</a>. Test dataset used to evaluate the model, not
used with aicc and <a href='SDMmodelCV-class.html'>SDMmodelCV</a> objects, default is <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>env</th>
      <td><p><a href='https://rdrr.io/pkg/raster/man/stack.html'>stack</a> containing the environmental variables, used
only with "aicc", default is <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>deprecated.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>character. The method used to compute the correlation matrix,
default "spearman".</p></td>
    </tr>
    <tr>
      <th>cor_th</th>
      <td><p>numeric. The correlation threshold used to select highly
correlated variables, default is 0.7.</p></td>
    </tr>
    <tr>
      <th>permut</th>
      <td><p>integer. Number of permutations, default is 10.</p></td>
    </tr>
    <tr>
      <th>use_pc</th>
      <td><p>logical, use percent contribution. If <code>TRUE</code> and the model is
trained using the <a href='Maxent-class.html'>Maxent</a> method, the algorithm uses the percent
contribution computed by Maxent software to score the variable importance,
default is <code>FALSE</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The <a href='SDMmodel-class.html'>SDMmodel</a> or <a href='SDMmodelCV-class.html'>SDMmodelCV</a> object trained
using the selected variables.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
<ul>
<li><p>To find highly correlated variables the following formula is used:
$$| coeff | \le cor_th$$</p></li>
</ul>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># \donttest{</span>
<span class='co'># Acquire environmental variables</span>
<span class='no'>files</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span>(<span class='kw'>path</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"dismo"</span>), <span class='st'>"ex"</span>),
                    <span class='kw'>pattern</span> <span class='kw'>=</span> <span class='st'>"grd"</span>, <span class='kw'>full.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>predictors</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>raster</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/stack.html'>stack</a></span>(<span class='no'>files</span>)

<span class='co'># Prepare presence and background locations</span>
<span class='no'>p_coords</span> <span class='kw'>&lt;-</span> <span class='no'>virtualSp</span>$<span class='no'>presence</span>
<span class='no'>bg_coords</span> <span class='kw'>&lt;-</span> <span class='no'>virtualSp</span>$<span class='no'>background</span>

<span class='co'># Create SWD object</span>
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='prepareSWD.html'>prepareSWD</a></span>(<span class='kw'>species</span> <span class='kw'>=</span> <span class='st'>"Virtual species"</span>, <span class='kw'>p</span> <span class='kw'>=</span> <span class='no'>p_coords</span>, <span class='kw'>a</span> <span class='kw'>=</span> <span class='no'>bg_coords</span>,
                   <span class='kw'>env</span> <span class='kw'>=</span> <span class='no'>predictors</span>, <span class='kw'>categorical</span> <span class='kw'>=</span> <span class='st'>"biome"</span>)

<span class='co'># Split presence locations in training (80%) and testing (20%) datasets</span>
<span class='no'>datasets</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='trainValTest.html'>trainValTest</a></span>(<span class='no'>data</span>, <span class='kw'>test</span> <span class='kw'>=</span> <span class='fl'>0.2</span>, <span class='kw'>only_presence</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>train</span> <span class='kw'>&lt;-</span> <span class='no'>datasets</span><span class='kw'>[[</span><span class='fl'>1</span>]]
<span class='no'>test</span> <span class='kw'>&lt;-</span> <span class='no'>datasets</span><span class='kw'>[[</span><span class='fl'>2</span>]]

<span class='co'># Train a model</span>
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='train.html'>train</a></span>(<span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"Maxnet"</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>train</span>, <span class='kw'>fc</span> <span class='kw'>=</span> <span class='st'>"l"</span>)

<span class='co'># Prepare background locations to test autocorrelation, this usually gives a</span>
<span class='co'># warning message given that less than 10000 points can be randomly sampled</span>
<span class='no'>bg_coords</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>dismo</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/dismo/man/randomPoints.html'>randomPoints</a></span>(<span class='no'>predictors</span>, <span class='fl'>10000</span>)
<span class='no'>bg</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='prepareSWD.html'>prepareSWD</a></span>(<span class='kw'>species</span> <span class='kw'>=</span> <span class='st'>"Virtual species"</span>, <span class='kw'>a</span> <span class='kw'>=</span> <span class='no'>bg_coords</span>,
                 <span class='kw'>env</span> <span class='kw'>=</span> <span class='no'>predictors</span>, <span class='kw'>categorical</span> <span class='kw'>=</span> <span class='st'>"biome"</span>)

<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># Remove variables with correlation higher than 0.7 accounting for the AUC,</span>
<span class='co'># in the following example the variable importance is computed as permutation</span>
<span class='co'># importance</span>
<span class='no'>vs</span> <span class='kw'>&lt;-</span> <span class='fu'>varSel</span>(<span class='no'>model</span>, <span class='kw'>metric</span> <span class='kw'>=</span> <span class='st'>"auc"</span>, <span class='kw'>bg4cor</span> <span class='kw'>=</span> <span class='no'>bg</span>, <span class='kw'>test</span> <span class='kw'>=</span> <span class='no'>test</span>, <span class='kw'>cor_th</span> <span class='kw'>=</span> <span class='fl'>0.7</span>,
             <span class='kw'>permut</span> <span class='kw'>=</span> <span class='fl'>1</span>)
<span class='no'>vs</span>

<span class='co'># Remove variables with correlation higher than 0.7 accounting for the TSS,</span>
<span class='co'># in the following example the variable importance is the MaxEnt percent</span>
<span class='co'># contribution</span>
<span class='co'># Train a model</span>
<span class='co'># The next line checks if Maxent is correctly configured but you don't need</span>
<span class='co'># to run it in your script</span>
<span class='kw'>if</span> (<span class='fu'><a href='checkMaxentInstallation.html'>checkMaxentInstallation</a></span>(<span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)) {
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='train.html'>train</a></span>(<span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"Maxent"</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>train</span>, <span class='kw'>fc</span> <span class='kw'>=</span> <span class='st'>"l"</span>)
<span class='no'>vs</span> <span class='kw'>&lt;-</span> <span class='fu'>varSel</span>(<span class='no'>model</span>, <span class='kw'>metric</span> <span class='kw'>=</span> <span class='st'>"tss"</span>, <span class='kw'>bg4cor</span> <span class='kw'>=</span> <span class='no'>bg</span>, <span class='kw'>test</span> <span class='kw'>=</span> <span class='no'>test</span>, <span class='kw'>cor_th</span> <span class='kw'>=</span> <span class='fl'>0.7</span>,
             <span class='kw'>use_pc</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>vs</span>

<span class='co'># Remove variables with correlation higher than 0.7 accounting for the aicc,</span>
<span class='co'># in the following example the variable importance is the MaxEnt percent</span>
<span class='co'># contribution</span>
<span class='no'>vs</span> <span class='kw'>&lt;-</span> <span class='fu'>varSel</span>(<span class='no'>model</span>, <span class='kw'>metric</span> <span class='kw'>=</span> <span class='st'>"aicc"</span>, <span class='kw'>bg4cor</span> <span class='kw'>=</span> <span class='no'>bg</span>, <span class='kw'>cor_th</span> <span class='kw'>=</span> <span class='fl'>0.7</span>,
             <span class='kw'>use_pc</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>env</span> <span class='kw'>=</span> <span class='no'>predictors</span>)
<span class='no'>vs</span>
}
}
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://github.com/sgvignali'>Sergio Vignali</a>, <a href='http://www.cb.iee.unibe.ch/about_us/barras_arnaud_gian/index_eng.html'>Arnaud Barras</a>, <a href='http://www.cb.iee.unibe.ch/about_us/dr_braunisch_veronika/index_eng.html'>Veronika Braunisch</a>, <a href='http://www.cb.iee.unibe.ch/index_eng.html'>Conservation Biology - University of Bern</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: 'f5b56329d14fa0bab34fea62e13b450d',
    indexName: 'sgvignali-sdmtune',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


