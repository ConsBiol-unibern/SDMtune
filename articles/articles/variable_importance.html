<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Variable Importance â€¢ SDMtune</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><!-- docsearch --><script src="../../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="Variable Importance">
<meta property="og:description" content="">
<meta property="og:image" content="https://consbiol-unibern.github.io/SDMtune/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">SDMtune</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/SDMtune.html">Get started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/prepare_data.html">Prepare data for the analysis</a>
    </li>
    <li>
      <a href="../../articles/articles/train_model.html">Train a model</a>
    </li>
    <li>
      <a href="../../articles/articles/make_predictions.html">Make predictions</a>
    </li>
    <li>
      <a href="../../articles/articles/evaluate_model.html">Evaluate a model</a>
    </li>
    <li>
      <a href="../../articles/articles/evaluation_strategies.html">Evaluation strategies</a>
    </li>
    <li>
      <a href="../../articles/articles/variable_importance.html">Variable importance</a>
    </li>
    <li>
      <a href="../../articles/articles/variable_selection.html">Data-driven variable selection</a>
    </li>
    <li>
      <a href="../../articles/articles/tune_hyperparameters.html">Tune model hyperparameters</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sgvignali/SDMtune">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Variable Importance</h1>
            
      
      
      <div class="hidden name"><code>variable_importance.Rmd</code></div>

    </div>

    
    
<pre><code>#&gt; Registered S3 methods overwritten by 'ggplot2':
#&gt;   method         from 
#&gt;   [.quosures     rlang
#&gt;   c.quosures     rlang
#&gt;   print.quosures rlang</code></pre>
<div id="intro" class="section level2">
<h2 class="hasAnchor">
<a href="#intro" class="anchor"></a>Intro</h2>
<p>In the previous articles you have learned how to <a href="./prepare_data.html">prepare the data</a> for the analysis, how to <a href="./train_model.html">train a model</a>, how to <a href="./make_predictions.html">make predictions</a>, how to <a href="./evaluate_model.html">evaluate a model</a> and two different <a href="./evaluation_strategies.html">evaluation strategies</a> using <strong>SDMtune</strong>. In this article you will learn how to display and plot the variable importance and how to plot the response curves.</p>
</div>
<div id="variable-importance-for-maxent-models" class="section level2">
<h2 class="hasAnchor">
<a href="#variable-importance-for-maxent-models" class="anchor"></a>Variable importance for Maxent models</h2>
<p>First we load the <strong>SDMtune</strong> package:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(SDMtune)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt;    _____  ____   __  ___ __</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt;   / ___/ / __ \ /  |/  // /_ __  __ ____   ___</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt;   \__ \ / / / // /|_/ // __// / / // __ \ / _ \</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt;  ___/ // /_/ // /  / // /_ / /_/ // / / //  __/</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; /____//_____//_/  /_/ \__/ \__,_//_/ /_/ \___/  version 0.1.0</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; To cite this package in publications type: citation("SDMtune").</span></a></code></pre></div>
<p>For a <strong>Maxent</strong> model we can get the variable importance values from the output of the MaxEnt Java software. These values are stored in the model object and can be extracted using the following command:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">default_model<span class="op">@</span>model<span class="op">@</span>results</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt;                                                                                         [,1]</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; X.Training.samples                                                                  510.0000</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; Regularized.training.gain                                                             1.5516</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; Unregularized.training.gain                                                           1.6969</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt; Iterations                                                                          500.0000</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt; Training.AUC                                                                          0.9340</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt; X.Background.points                                                                5000.0000</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt; bio1.contribution                                                                    35.9528</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt; bio12.contribution                                                                    0.1700</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt; bio16.contribution                                                                    2.0476</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; bio17.contribution                                                                    4.8377</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt; bio5.contribution                                                                    27.2611</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; bio6.contribution                                                                     0.4814</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt; bio7.contribution                                                                    12.4123</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt; bio8.contribution                                                                     9.4732</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt; biome.contribution                                                                    7.3639</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt; bio1.permutation.importance                                                          42.9343</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt; bio12.permutation.importance                                                          0.6742</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt; bio16.permutation.importance                                                          1.9352</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt; bio17.permutation.importance                                                         10.9898</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt; bio5.permutation.importance                                                          16.2334</span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt; bio6.permutation.importance                                                           7.8030</span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co">#&gt; bio7.permutation.importance                                                           9.5452</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co">#&gt; bio8.permutation.importance                                                           5.1536</span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="co">#&gt; biome.permutation.importance                                                          4.7314</span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27"><span class="co">#&gt; Entropy                                                                               6.9754</span></a>
<a class="sourceLine" id="cb3-28" data-line-number="28"><span class="co">#&gt; Prevalence..average.probability.of.presence.over.background.sites.                    0.1239</span></a>
<a class="sourceLine" id="cb3-29" data-line-number="29"><span class="co">#&gt; Fixed.cumulative.value.1.cumulative.threshold                                         1.0000</span></a>
<a class="sourceLine" id="cb3-30" data-line-number="30"><span class="co">#&gt; Fixed.cumulative.value.1.Cloglog.threshold                                            0.0198</span></a>
<a class="sourceLine" id="cb3-31" data-line-number="31"><span class="co">#&gt; Fixed.cumulative.value.1.area                                                         0.4270</span></a>
<a class="sourceLine" id="cb3-32" data-line-number="32"><span class="co">#&gt; Fixed.cumulative.value.1.training.omission                                            0.0020</span></a>
<a class="sourceLine" id="cb3-33" data-line-number="33"><span class="co">#&gt; Fixed.cumulative.value.5.cumulative.threshold                                         5.0000</span></a>
<a class="sourceLine" id="cb3-34" data-line-number="34"><span class="co">#&gt; Fixed.cumulative.value.5.Cloglog.threshold                                            0.1061</span></a>
<a class="sourceLine" id="cb3-35" data-line-number="35"><span class="co">#&gt; Fixed.cumulative.value.5.area                                                         0.2606</span></a>
<a class="sourceLine" id="cb3-36" data-line-number="36"><span class="co">#&gt; Fixed.cumulative.value.5.training.omission                                            0.0255</span></a>
<a class="sourceLine" id="cb3-37" data-line-number="37"><span class="co">#&gt; Fixed.cumulative.value.10.cumulative.threshold                                       10.0000</span></a>
<a class="sourceLine" id="cb3-38" data-line-number="38"><span class="co">#&gt; Fixed.cumulative.value.10.Cloglog.threshold                                           0.1907</span></a>
<a class="sourceLine" id="cb3-39" data-line-number="39"><span class="co">#&gt; Fixed.cumulative.value.10.area                                                        0.1948</span></a>
<a class="sourceLine" id="cb3-40" data-line-number="40"><span class="co">#&gt; Fixed.cumulative.value.10.training.omission                                           0.0529</span></a>
<a class="sourceLine" id="cb3-41" data-line-number="41"><span class="co">#&gt; Minimum.training.presence.cumulative.threshold                                        0.1143</span></a>
<a class="sourceLine" id="cb3-42" data-line-number="42"><span class="co">#&gt; Minimum.training.presence.Cloglog.threshold                                           0.0022</span></a>
<a class="sourceLine" id="cb3-43" data-line-number="43"><span class="co">#&gt; Minimum.training.presence.area                                                        0.6732</span></a>
<a class="sourceLine" id="cb3-44" data-line-number="44"><span class="co">#&gt; Minimum.training.presence.training.omission                                           0.0000</span></a>
<a class="sourceLine" id="cb3-45" data-line-number="45"><span class="co">#&gt; X10.percentile.training.presence.cumulative.threshold                                17.9210</span></a>
<a class="sourceLine" id="cb3-46" data-line-number="46"><span class="co">#&gt; X10.percentile.training.presence.Cloglog.threshold                                    0.3315</span></a>
<a class="sourceLine" id="cb3-47" data-line-number="47"><span class="co">#&gt; X10.percentile.training.presence.area                                                 0.1370</span></a>
<a class="sourceLine" id="cb3-48" data-line-number="48"><span class="co">#&gt; X10.percentile.training.presence.training.omission                                    0.1000</span></a>
<a class="sourceLine" id="cb3-49" data-line-number="49"><span class="co">#&gt; Equal.training.sensitivity.and.specificity.cumulative.threshold                      21.0203</span></a>
<a class="sourceLine" id="cb3-50" data-line-number="50"><span class="co">#&gt; Equal.training.sensitivity.and.specificity.Cloglog.threshold                          0.3896</span></a>
<a class="sourceLine" id="cb3-51" data-line-number="51"><span class="co">#&gt; Equal.training.sensitivity.and.specificity.area                                       0.1222</span></a>
<a class="sourceLine" id="cb3-52" data-line-number="52"><span class="co">#&gt; Equal.training.sensitivity.and.specificity.training.omission                          0.1216</span></a>
<a class="sourceLine" id="cb3-53" data-line-number="53"><span class="co">#&gt; Maximum.training.sensitivity.plus.specificity.cumulative.threshold                   13.7511</span></a>
<a class="sourceLine" id="cb3-54" data-line-number="54"><span class="co">#&gt; Maximum.training.sensitivity.plus.specificity.Cloglog.threshold                       0.2576</span></a>
<a class="sourceLine" id="cb3-55" data-line-number="55"><span class="co">#&gt; Maximum.training.sensitivity.plus.specificity.area                                    0.1624</span></a>
<a class="sourceLine" id="cb3-56" data-line-number="56"><span class="co">#&gt; Maximum.training.sensitivity.plus.specificity.training.omission                       0.0706</span></a>
<a class="sourceLine" id="cb3-57" data-line-number="57"><span class="co">#&gt; Balance.training.omission..predicted.area.and.threshold.value.cumulative.threshold    2.3855</span></a>
<a class="sourceLine" id="cb3-58" data-line-number="58"><span class="co">#&gt; Balance.training.omission..predicted.area.and.threshold.value.Cloglog.threshold       0.0490</span></a>
<a class="sourceLine" id="cb3-59" data-line-number="59"><span class="co">#&gt; Balance.training.omission..predicted.area.and.threshold.value.area                    0.3354</span></a>
<a class="sourceLine" id="cb3-60" data-line-number="60"><span class="co">#&gt; Balance.training.omission..predicted.area.and.threshold.value.training.omission       0.0098</span></a>
<a class="sourceLine" id="cb3-61" data-line-number="61"><span class="co">#&gt; Equate.entropy.of.thresholded.and.original.distributions.cumulative.threshold         8.2429</span></a>
<a class="sourceLine" id="cb3-62" data-line-number="62"><span class="co">#&gt; Equate.entropy.of.thresholded.and.original.distributions.Cloglog.threshold            0.1662</span></a>
<a class="sourceLine" id="cb3-63" data-line-number="63"><span class="co">#&gt; Equate.entropy.of.thresholded.and.original.distributions.area                         0.2140</span></a>
<a class="sourceLine" id="cb3-64" data-line-number="64"><span class="co">#&gt; Equate.entropy.of.thresholded.and.original.distributions.training.omission            0.0490</span></a></code></pre></div>
<p>The function <code><a href="../../reference/maxentVarImp.html">maxentVarImp()</a></code> extracts the variable importance values from the previous output and formats them in a more human readable way:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">vi &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/maxentVarImp.html">maxentVarImp</a></span>(default_model)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">vi</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt;   Variable Percent_contribution Permutation_importance</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; 1     bio1                 36.0                   42.9</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; 2     bio5                 27.3                   16.2</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; 3     bio7                 12.4                    9.5</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; 4     bio8                  9.5                    5.2</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; 5    biome                  7.4                    4.7</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; 6    bio17                  4.8                   11.0</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt; 7    bio16                  2.0                    1.9</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt; 8     bio6                  0.5                    7.8</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; 9    bio12                  0.2                    0.7</span></a></code></pre></div>
<p>As you can see the function returns a <code>data.frame</code> with the variable name, the percent contribution and the permutation importance.</p>
<p>You can plot the variable importance as a bar chart using the function <code><a href="../../reference/plotVarImp.html">plotVarImp()</a></code>. For example you can plot the percent contribution using:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="../../reference/plotVarImp.html">plotVarImp</a></span>(vi[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</a></code></pre></div>
<p><img src="variable_importance_files/figure-html/maxent%20percent%20contribution%20plot-1.png" width="700" style="display: block; margin: auto;"></p>
<div id="try-yourself" class="section level3">
<h3 class="hasAnchor">
<a href="#try-yourself" class="anchor"></a>Try yourself</h3>
<p>Plot the permutation importance as a bar chart. To see the solution highlight the following cell:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r exercise"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># The function accepts a data.frame with 2 columns: one with the variable name</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co"># and one with the values, so it is enough to select the first and the third</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co"># columns from the vi data.frame</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="kw"><a href="../../reference/plotVarImp.html">plotVarImp</a></span>(vi[, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>)])</a></code></pre></div>
<p><strong>SDMtune</strong> has its own function to compute the permutation importance that iterates through several permutations and return an averaged value together with the standard deviation. We will use this function to compute the permutation importance of a <strong>Maxnet</strong> model.</p>
</div>
</div>
<div id="permutation-importance" class="section level2">
<h2 class="hasAnchor">
<a href="#permutation-importance" class="anchor"></a>Permutation importance</h2>
<p>For this example will use a <strong>Maxnet</strong> model and a training/testing validation strategy like in the <a href="./evaluation_strategies.html#train-and-testing-datasets">previous article</a>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(zeallot)  <span class="co"># For unpacking assignment</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(train, test) <span class="op">%&lt;-%</span><span class="st"> </span><span class="kw"><a href="../../reference/trainValTest.html">trainValTest</a></span>(presence, <span class="dt">test =</span> <span class="fl">0.2</span>, <span class="dt">seed =</span> <span class="dv">25</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">maxnet_model &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/train.html">train</a></span>(<span class="st">"Maxnet"</span>, <span class="dt">p =</span> train, <span class="dt">a =</span> bg_model)</a></code></pre></div>
<p>Now we can calculate the variable importance with the function <code><a href="../../reference/varImp.html">varImp()</a></code> using 5 permutations:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">vi_maxnet &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/varImp.html">varImp</a></span>(maxnet_model, <span class="dt">permut =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">vi_maxnet</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt;   Variable Permutation_importance    sd</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; 1     bio1                   43.1 0.006</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt; 2     bio5                   15.4 0.005</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; 3     bio7                    8.6 0.006</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt; 4    biome                    7.9 0.005</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; 5     bio8                    6.8 0.004</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt; 6    bio17                    6.7 0.003</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt; 7     bio6                    6.6 0.003</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; 8    bio16                    3.7 0.002</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt; 9    bio12                    1.2 0.001</span></a></code></pre></div>
<p>And plot it with:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="../../reference/plotVarImp.html">plotVarImp</a></span>(vi_maxnet)</a></code></pre></div>
<p><img src="variable_importance_files/figure-html/plot%20var%20imp-1.png" width="700" style="display: block; margin: auto;"></p>
<div id="try-yourself-1" class="section level3">
<h3 class="hasAnchor">
<a href="#try-yourself-1" class="anchor"></a>Try yourself</h3>
<p>Use the <code><a href="../../reference/varImp.html">varImp()</a></code> function to compute the permutation importance for the <code>default_model</code> using 10 permutations and compare the results with the Maxent output. To see the solution highlight the following cell:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r exercise"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># Compute the permutation importance</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">vi_maxent &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/varImp.html">varImp</a></span>(default_model, <span class="dt">permut =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co"># Print it</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4">vi_maxent</a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co"># Compare with Maxent output</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="kw"><a href="../../reference/maxentVarImp.html">maxentVarImp</a></span>(default_model)</a></code></pre></div>
<p>The difference is probably due to a different shuffling of the presence and background locations during the permutation process and because in this example we performed 10 permutations and averaged the values.</p>
</div>
</div>
<div id="jackknife-test-for-variable-importance" class="section level2">
<h2 class="hasAnchor">
<a href="#jackknife-test-for-variable-importance" class="anchor"></a>Jackknife test for variable importance</h2>
<p>Another method to estimate the variable importance is the leave one out Jackknife test. The test removes one variable at time and records the change in the chosen metric. We use the function <code><a href="../../reference/doJk.html">doJk()</a></code>, the AUC as evaluation metric and the <code>maxnet_model</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">jk &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/doJk.html">doJk</a></span>(maxnet_model, <span class="dt">metric =</span> <span class="st">"auc"</span>, <span class="dt">test =</span> test)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">jk</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt;   Variable Train_AUC_without Train_AUC_withonly Test_AUC_without</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt; 1     bio1            0.9332             0.8485           0.9334</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt; 2    bio12            0.9356             0.7207           0.9334</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt; 3    bio16            0.9335             0.7050           0.9335</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; 4    bio17            0.9351             0.6475           0.9329</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt; 5     bio5            0.9326             0.8688           0.9302</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#&gt; 6     bio6            0.9328             0.8040           0.9317</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt; 7     bio7            0.9331             0.7224           0.9322</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#&gt; 8     bio8            0.9318             0.8390           0.9330</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt; 9    biome            0.9282             0.7662           0.9252</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#&gt;   Test_AUC_withonly</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co">#&gt; 1            0.8605</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co">#&gt; 2            0.7742</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="co">#&gt; 3            0.7427</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="co">#&gt; 4            0.7015</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="co">#&gt; 5            0.8781</span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="co">#&gt; 6            0.8069</span></a>
<a class="sourceLine" id="cb11-20" data-line-number="20"><span class="co">#&gt; 7            0.7767</span></a>
<a class="sourceLine" id="cb11-21" data-line-number="21"><span class="co">#&gt; 8            0.8555</span></a>
<a class="sourceLine" id="cb11-22" data-line-number="22"><span class="co">#&gt; 9            0.7897</span></a></code></pre></div>
<p>We can also plot the output using the function <code><a href="../../reference/plotJk.html">plotJk()</a></code>. In the following example we plot the previous result and we add a line representing the AUC of the full model trained using all the variables. First we plot the Jackknife test for the training AUC:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="../../reference/plotJk.html">plotJk</a></span>(jk, <span class="dt">type =</span> <span class="st">"train"</span>, <span class="dt">ref =</span> <span class="kw"><a href="../../reference/auc.html">auc</a></span>(maxnet_model))</a></code></pre></div>
<p><img src="variable_importance_files/figure-html/plot%20jk%20train-1.png" width="700" style="display: block; margin: auto;"></p>
<p>and the Jackknife test for the testing AUC:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="../../reference/plotJk.html">plotJk</a></span>(jk, <span class="dt">type =</span> <span class="st">"train"</span>, <span class="dt">ref =</span> <span class="kw"><a href="../../reference/auc.html">auc</a></span>(maxnet_model, <span class="dt">test =</span> test))</a></code></pre></div>
<p><img src="variable_importance_files/figure-html/plot%20jk%20test-1.png" width="700" style="display: block; margin: auto;"></p>
<div id="try-yourself-2" class="section level3">
<h3 class="hasAnchor">
<a href="#try-yourself-2" class="anchor"></a>Try yourself</h3>
<p>Repeat the Jackknife part using the TSS and the AICc as evaluation metric and using the <code>dafult_model</code></p>
</div>
</div>
<div id="response-curves" class="section level2">
<h2 class="hasAnchor">
<a href="#response-curves" class="anchor"></a>Response curves</h2>
<p>With the function <code><a href="../../reference/plotResponse.html">plotResponse()</a></code> is possible to plot the marginal and the univariate response curve. Letâ€™s plot the <strong>cloglog</strong> univariate response curve of <strong>bio1</strong>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="../../reference/plotResponse.html">plotResponse</a></span>(maxnet_model, <span class="dt">var =</span> <span class="st">"bio1"</span>, <span class="dt">type =</span> <span class="st">"cloglog"</span>, <span class="dt">marginal =</span> <span class="ot">FALSE</span>, <span class="dt">rug =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="variable_importance_files/figure-html/plot%20bio1-1.png" width="700" style="display: block; margin: auto;"></p>
<p>On top is displayed the rug of the presence locations and on bottom the rug of the background locations. As another example we can plot the <strong>logistic</strong> marginal response curve of <strong>biome</strong> that is a categorical variable, keeping the other variables at the mean value:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="../../reference/plotResponse.html">plotResponse</a></span>(maxnet_model, <span class="dt">var =</span> <span class="st">"biome"</span>, <span class="dt">type =</span> <span class="st">"logistic"</span>, <span class="dt">marginal =</span> <span class="ot">TRUE</span>, <span class="dt">fun =</span> mean, <span class="dt">color =</span> <span class="st">"blue"</span>)</a></code></pre></div>
<p><img src="variable_importance_files/figure-html/plot%20biome-1.png" width="700" style="display: block; margin: auto;"></p>
<div id="try-yourself-3" class="section level3">
<h3 class="hasAnchor">
<a href="#try-yourself-3" class="anchor"></a>Try yourself</h3>
<p>Plot in green the univariate cloglog response curve of <strong>bio17</strong> removing the rug and using the <code>default_model</code>, to see the solution highlight the following cell:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r exercise"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="../../reference/plotResponse.html">plotResponse</a></span>(default_model, <span class="dt">var =</span> <span class="st">"bio17"</span>, <span class="dt">type =</span> <span class="st">"cloglog"</span>, <span class="dt">marginal =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="st">"green"</span>)</a></code></pre></div>
<p>In the case of an <code><a href="../../reference/SDMmodelCV-class.html">SDMmodelCV()</a></code> the response curve shows the averaged value of the prediction together with the one Standard Deviation error interval. We use the cross validation model trained in the <a href="./evaluation_strategies.html#cross-validation">previous article</a></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw"><a href="../../reference/plotResponse.html">plotResponse</a></span>(cv_model, <span class="dt">var =</span> <span class="st">"bio1"</span>, <span class="dt">type =</span> <span class="st">"cloglog"</span>, <span class="dt">marginal =</span> <span class="ot">TRUE</span>, <span class="dt">fun =</span> mean, <span class="dt">rug =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="variable_importance_files/figure-html/plot%20cv%20response-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="model-report" class="section level2">
<h2 class="hasAnchor">
<a href="#model-report" class="anchor"></a>Model report</h2>
<p>All what you have learned till now con be saved and summarized calling the function <code><a href="../../reference/modelReport.html">modelReport()</a></code>. The function will create a folder with the provided name and:</p>
<ul>
<li>save the training, background and testing locations in separated csv files;</li>
<li>train and evaluate the model;</li>
<li>create a report in a html format with the ROC curve, threshold values, response curves, predicted map and Jackknife test;</li>
<li>save the predicted distribution map;</li>
<li>save all the curves in the plot folder;</li>
<li>save the model with <code>.Rds</code> extension that can be loaded in R using the <code>read.RDS</code> function.</li>
</ul>
<p>The function is totally inspired by the default output of the MaxEnt Java software <span class="citation">[@Phillips2006]</span> and extends it to other methods (for the moment only <strong>Maxnet</strong>). You can decide what to include in the report using dedicated function arguments, like <code>response_curves</code>, <code>jk</code> and <code>env</code> but the function cannot be used with <code><a href="../../reference/SDMmodelCV-class.html">SDMmodelCV()</a></code> objects. Run the following code to create a report of the <strong>Maxnet</strong> model we trained before:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw"><a href="../../reference/modelReport.html">modelReport</a></span>(maxnet_model, <span class="dt">type =</span> <span class="st">"cloglog"</span>, <span class="dt">folder =</span> <span class="st">"condor"</span>, <span class="dt">test =</span> test, <span class="dt">response_curves =</span> <span class="ot">TRUE</span>, <span class="dt">jk =</span> <span class="ot">TRUE</span>, <span class="dt">env =</span> predictors)</a></code></pre></div>
<p>The output is displayed in the browser and all the files are saved in the <strong>condor</strong> folder.</p>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h2>
<p>In this article you have learned:</p>
<ul>
<li>how to get and plot the variable importance for <strong>Maxent</strong> models;</li>
<li>how to compute and plot the permutation importance;</li>
<li>how to perform the leave one out Jackknife test;</li>
<li>how to plot the marginal and the univariate response curve;</li>
<li>how to create a model report.</li>
</ul>
<p>In the <a href="./variable_selection.html">next article</a> you will learn how to perform data-driven variable selection.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#intro">Intro</a></li>
      <li><a href="#variable-importance-for-maxent-models">Variable importance for Maxent models</a></li>
      <li><a href="#permutation-importance">Permutation importance</a></li>
      <li><a href="#jackknife-test-for-variable-importance">Jackknife test for variable importance</a></li>
      <li><a href="#response-curves">Response curves</a></li>
      <li><a href="#model-report">Model report</a></li>
      <li><a href="#conclusion">Conclusion</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/sgvignali">Sergio Vignali</a>, <a href="http://www.cb.iee.unibe.ch/about_us/barras_arnaud_gian/index_eng.html">Arnaud Barras</a>, <a href="http://www.cb.iee.unibe.ch/about_us/dr_braunisch_veronika/index_eng.html">Veronika Braunisch</a>, <a href="http://www.cb.iee.unibe.ch/index_eng.html">Conservation Biology - University of Bern</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'f5b56329d14fa0bab34fea62e13b450d',
    indexName: 'sgvignali-sdmtune',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
